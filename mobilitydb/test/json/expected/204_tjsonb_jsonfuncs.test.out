SELECT tjsonb '"{\"geom\": \"Point(1 1)\"}"@2000-01-01' - 'geom';
            ?column?             
---------------------------------
 {}@Sat Jan 01 00:00:00 2000 PST
(1 row)

SELECT tjsonb '{{"geom": "Point(1 1)"}@2000-01-01, {"geom": "Point(1 1)"}@2000-01-02, {"geom": "Point(1 1)"}@2000-01-03}' - 'geom';
                                              ?column?                                               
-----------------------------------------------------------------------------------------------------
 {{}@Sat Jan 01 00:00:00 2000 PST, {}@Sun Jan 02 00:00:00 2000 PST, {}@Mon Jan 03 00:00:00 2000 PST}
(1 row)

SELECT tjsonb '[{"geom": "Point(1 1)"}@2000-01-01, {"geom": "Point(1 1)"}@2000-01-02, {"geom": "Point(1 1)"}@2000-01-03]' - 'geom';
                              ?column?                              
--------------------------------------------------------------------
 [{}@Sat Jan 01 00:00:00 2000 PST, {}@Mon Jan 03 00:00:00 2000 PST]
(1 row)

SELECT tjsonb '{[{"geom": "Point(1 1)"}@2000-01-01, {"geom": "Point(1 1)"}@2000-01-02, {"geom": "Point(1 1)"}@2000-01-03],[{"geom": "Point(2 2)"}@2000-01-04, {"geom": "Point(2 2)"}@2000-01-05]}' - 'geom';
                                                                 ?column?                                                                 
------------------------------------------------------------------------------------------------------------------------------------------
 {[{}@Sat Jan 01 00:00:00 2000 PST, {}@Mon Jan 03 00:00:00 2000 PST], [{}@Tue Jan 04 00:00:00 2000 PST, {}@Wed Jan 05 00:00:00 2000 PST]}
(1 row)

SELECT tjsonb '"{\"geom\": \"Point(1 1)\"}"@2000-01-01' - 'xxx';
                      ?column?                       
-----------------------------------------------------
 {"geom": "Point(1 1)"}@Sat Jan 01 00:00:00 2000 PST
(1 row)

SELECT tjsonb '{{"geom": "Point(1 1)"}@2000-01-01, {"geom": "Point(1 1)"}@2000-01-02, {"geom": "Point(1 1)"}@2000-01-03}' - 'xxx';
                                                                            ?column?                                                                             
-----------------------------------------------------------------------------------------------------------------------------------------------------------------
 {{"geom": "Point(1 1)"}@Sat Jan 01 00:00:00 2000 PST, {"geom": "Point(1 1)"}@Sun Jan 02 00:00:00 2000 PST, {"geom": "Point(1 1)"}@Mon Jan 03 00:00:00 2000 PST}
(1 row)

SELECT tjsonb '[{"geom": "Point(1 1)"}@2000-01-01, {"geom": "Point(1 1)"}@2000-01-02, {"geom": "Point(1 1)"}@2000-01-03]' - 'xxx';
                                                  ?column?                                                  
------------------------------------------------------------------------------------------------------------
 [{"geom": "Point(1 1)"}@Sat Jan 01 00:00:00 2000 PST, {"geom": "Point(1 1)"}@Mon Jan 03 00:00:00 2000 PST]
(1 row)

SELECT tjsonb '{[{"geom": "Point(1 1)"}@2000-01-01, {"geom": "Point(1 1)"}@2000-01-02, {"geom": "Point(1 1)"}@2000-01-03],[{"geom": "Point(2 2)"}@2000-01-04, {"geom": "Point(2 2)"}@2000-01-05]}' - 'xxx';
                                                                                                         ?column?                                                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {[{"geom": "Point(1 1)"}@Sat Jan 01 00:00:00 2000 PST, {"geom": "Point(1 1)"}@Mon Jan 03 00:00:00 2000 PST], [{"geom": "Point(2 2)"}@Tue Jan 04 00:00:00 2000 PST, {"geom": "Point(2 2)"}@Wed Jan 05 00:00:00 2000 PST]}
(1 row)

SELECT tjsonb '"{\"geom\": \"Point(1 1)\"}"@2000-01-01' - ARRAY[text 'geom'];
            ?column?             
---------------------------------
 {}@Sat Jan 01 00:00:00 2000 PST
(1 row)

SELECT tjsonb '{{"geom": "Point(1 1)"}@2000-01-01, {"geom": "Point(1 1)"}@2000-01-02, {"geom": "Point(1 1)"}@2000-01-03}' - ARRAY[text 'geom'];
                                              ?column?                                               
-----------------------------------------------------------------------------------------------------
 {{}@Sat Jan 01 00:00:00 2000 PST, {}@Sun Jan 02 00:00:00 2000 PST, {}@Mon Jan 03 00:00:00 2000 PST}
(1 row)

SELECT tjsonb '[{"geom": "Point(1 1)"}@2000-01-01, {"geom": "Point(1 1)"}@2000-01-02, {"geom": "Point(1 1)"}@2000-01-03]' - ARRAY[text 'geom'];
                              ?column?                              
--------------------------------------------------------------------
 [{}@Sat Jan 01 00:00:00 2000 PST, {}@Mon Jan 03 00:00:00 2000 PST]
(1 row)

SELECT tjsonb '{[{"geom": "Point(1 1)"}@2000-01-01, {"geom": "Point(1 1)"}@2000-01-02, {"geom": "Point(1 1)"}@2000-01-03],[{"geom": "Point(2 2)"}@2000-01-04, {"geom": "Point(2 2)"}@2000-01-05]}' - ARRAY[text 'geom'];
                                                                 ?column?                                                                 
------------------------------------------------------------------------------------------------------------------------------------------
 {[{}@Sat Jan 01 00:00:00 2000 PST, {}@Mon Jan 03 00:00:00 2000 PST], [{}@Tue Jan 04 00:00:00 2000 PST, {}@Wed Jan 05 00:00:00 2000 PST]}
(1 row)

SELECT tjsonb '"[\"Point(1 1)\", \"Point(2 2)\"]"@2000-01-01' - 0;
                  ?column?                   
---------------------------------------------
 ["Point(2 2)"]@Sat Jan 01 00:00:00 2000 PST
(1 row)

SELECT tjsonb '{"[\"Point(1 1)\", \"Point(2 2)\"]"@2000-01-01, "[\"Point(2 2)\", \"Point(3 3)\"]"@2000-01-02, "[\"Point(1 1)\", \"Point(2 2)\"]"@2000-01-03}' - 0;
                                                                ?column?                                                                 
-----------------------------------------------------------------------------------------------------------------------------------------
 {["Point(2 2)"]@Sat Jan 01 00:00:00 2000 PST, ["Point(3 3)"]@Sun Jan 02 00:00:00 2000 PST, ["Point(2 2)"]@Mon Jan 03 00:00:00 2000 PST}
(1 row)

SELECT tjsonb '["[\"Point(1 1)\", \"Point(2 2)\"]"@2000-01-01, "[\"Point(2 2)\", \"Point(3 3)\"]"@2000-01-02, "[\"Point(1 1)\", \"Point(2 2)\"]"@2000-01-03]' - 0;
                                                                ?column?                                                                 
-----------------------------------------------------------------------------------------------------------------------------------------
 [["Point(2 2)"]@Sat Jan 01 00:00:00 2000 PST, ["Point(3 3)"]@Sun Jan 02 00:00:00 2000 PST, ["Point(2 2)"]@Mon Jan 03 00:00:00 2000 PST]
(1 row)

SELECT tjsonb '{["[\"Point(1 1)\", \"Point(2 2)\"]"@2000-01-01, "[\"Point(2 2)\", \"Point(3 3)\"]"@2000-01-02, "[\"Point(1 1)\", \"Point(2 2)\"]"@2000-01-03],["[\"Point(2 2)\", \"Point(3 3)\"]"@2000-01-04, "[\"Point(2 2)\", \"Point(3 3)\"]"@2000-01-05]}' - 0;
                                                                                                               ?column?                                                                                                                
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {[["Point(2 2)"]@Sat Jan 01 00:00:00 2000 PST, ["Point(3 3)"]@Sun Jan 02 00:00:00 2000 PST, ["Point(2 2)"]@Mon Jan 03 00:00:00 2000 PST], [["Point(3 3)"]@Tue Jan 04 00:00:00 2000 PST, ["Point(3 3)"]@Wed Jan 05 00:00:00 2000 PST]}
(1 row)

/* Errors */
SELECT tjsonb '"{\"geom\": \"Point(1 1)\"}"@2000-01-01' - 0;
ERROR:  cannot delete from object using integer index
SELECT tjsonb '{{"geom": "Point(1 1)"}@2000-01-01, {"geom": "Point(1 1)"}@2000-01-02, {"geom": "Point(1 1)"}@2000-01-03}' - 0;
ERROR:  cannot delete from object using integer index
SELECT tjsonb '[{"geom": "Point(1 1)"}@2000-01-01, {"geom": "Point(1 1)"}@2000-01-02, {"geom": "Point(1 1)"}@2000-01-03]' - 0;
ERROR:  cannot delete from object using integer index
SELECT tjsonb '{[{"geom": "Point(1 1)"}@2000-01-01, {"geom": "Point(1 1)"}@2000-01-02, {"geom": "Point(1 1)"}@2000-01-03],[{"geom": "Point(2 2)"}@2000-01-04, {"geom": "Point(2 2)"}@2000-01-05]}' - 0;
ERROR:  cannot delete from object using integer index
SELECT tjsonb '"{\"geom\": \"Point(1 1)\"}"@2000-01-01' #- ARRAY[text 'geom'];
            ?column?             
---------------------------------
 {}@Sat Jan 01 00:00:00 2000 PST
(1 row)

SELECT tjsonb '{{"geom": "Point(1 1)"}@2000-01-01, {"geom": "Point(1 1)"}@2000-01-02, {"geom": "Point(1 1)"}@2000-01-03}' #- ARRAY[text 'geom'];
                                              ?column?                                               
-----------------------------------------------------------------------------------------------------
 {{}@Sat Jan 01 00:00:00 2000 PST, {}@Sun Jan 02 00:00:00 2000 PST, {}@Mon Jan 03 00:00:00 2000 PST}
(1 row)

SELECT tjsonb '[{"geom": "Point(1 1)"}@2000-01-01, {"geom": "Point(1 1)"}@2000-01-02, {"geom": "Point(1 1)"}@2000-01-03]' #- ARRAY[text 'geom'];
                              ?column?                              
--------------------------------------------------------------------
 [{}@Sat Jan 01 00:00:00 2000 PST, {}@Mon Jan 03 00:00:00 2000 PST]
(1 row)

SELECT tjsonb '{[{"geom": "Point(1 1)"}@2000-01-01, {"geom": "Point(1 1)"}@2000-01-02, {"geom": "Point(1 1)"}@2000-01-03],[{"geom": "Point(2 2)"}@2000-01-04, {"geom": "Point(2 2)"}@2000-01-05]}' #- ARRAY[text 'geom'];
                                                                 ?column?                                                                 
------------------------------------------------------------------------------------------------------------------------------------------
 {[{}@Sat Jan 01 00:00:00 2000 PST, {}@Mon Jan 03 00:00:00 2000 PST], [{}@Tue Jan 04 00:00:00 2000 PST, {}@Wed Jan 05 00:00:00 2000 PST]}
(1 row)

SELECT tjsonb_set(tjsonb '"{\"speed\": 10}"@2000-01-01', ARRAY['units'], '"km/h"'::jsonb);
                         tjsonb_set                          
-------------------------------------------------------------
 {"speed": 10, "units": "km/h"}@Sat Jan 01 00:00:00 2000 PST
(1 row)

SELECT tjsonb_set(tjsonb '{{"speed": 10}@2000-01-01, {"speed": 20}@2000-01-02, {"speed": 30}@2000-01-03}', ARRAY['units'], '"km/h"'::jsonb);
                                                                                       tjsonb_set                                                                                        
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {{"speed": 10, "units": "km/h"}@Sat Jan 01 00:00:00 2000 PST, {"speed": 20, "units": "km/h"}@Sun Jan 02 00:00:00 2000 PST, {"speed": 30, "units": "km/h"}@Mon Jan 03 00:00:00 2000 PST}
(1 row)

SELECT tjsonb_set(tjsonb '[{"speed": 10}@2000-01-01, {"speed": 20}@2000-01-02, {"speed": 30}@2000-01-03]', ARRAY['units'], '"km/h"'::jsonb);
                                                                                       tjsonb_set                                                                                        
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 [{"speed": 10, "units": "km/h"}@Sat Jan 01 00:00:00 2000 PST, {"speed": 20, "units": "km/h"}@Sun Jan 02 00:00:00 2000 PST, {"speed": 30, "units": "km/h"}@Mon Jan 03 00:00:00 2000 PST]
(1 row)

SELECT tjsonb_set(tjsonb '{[{"speed": 10}@2000-01-01, {"speed": 20}@2000-01-02, {"speed": 30}@2000-01-03],[{"geom": 30}@2000-01-04, {"speed": 30}@2000-01-05]}', ARRAY['units'], '"km/h"'::jsonb);
                                                                                                                                                      tjsonb_set                                                                                                                                                      
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {[{"speed": 10, "units": "km/h"}@Sat Jan 01 00:00:00 2000 PST, {"speed": 20, "units": "km/h"}@Sun Jan 02 00:00:00 2000 PST, {"speed": 30, "units": "km/h"}@Mon Jan 03 00:00:00 2000 PST], [{"geom": 30, "units": "km/h"}@Tue Jan 04 00:00:00 2000 PST, {"speed": 30, "units": "km/h"}@Wed Jan 05 00:00:00 2000 PST]}
(1 row)

SELECT tjsonb_insert(tjsonb '"{\"speed\": 10}"@2000-01-01', ARRAY['units'], '"km/h"'::jsonb);
               tjsonb_insert                
--------------------------------------------
 {"speed": 10}@Sat Jan 01 00:00:00 2000 PST
(1 row)

SELECT tjsonb_insert(tjsonb '{{"speed": 10}@2000-01-01, {"speed": 20}@2000-01-02, {"speed": 30}@2000-01-03}', ARRAY['units'], '"km/h"'::jsonb);
                                                            tjsonb_insert                                                             
--------------------------------------------------------------------------------------------------------------------------------------
 {{"speed": 10}@Sat Jan 01 00:00:00 2000 PST, {"speed": 20}@Sun Jan 02 00:00:00 2000 PST, {"speed": 30}@Mon Jan 03 00:00:00 2000 PST}
(1 row)

SELECT tjsonb_insert(tjsonb '[{"speed": 10}@2000-01-01, {"speed": 20}@2000-01-02, {"speed": 30}@2000-01-03]', ARRAY['units'], '"km/h"'::jsonb);
                                                            tjsonb_insert                                                             
--------------------------------------------------------------------------------------------------------------------------------------
 [{"speed": 10}@Sat Jan 01 00:00:00 2000 PST, {"speed": 20}@Sun Jan 02 00:00:00 2000 PST, {"speed": 30}@Mon Jan 03 00:00:00 2000 PST]
(1 row)

SELECT tjsonb_insert(tjsonb '{[{"speed": 10}@2000-01-01, {"speed": 20}@2000-01-02, {"speed": 30}@2000-01-03],[{"geom": 30}@2000-01-04, {"speed": 30}@2000-01-05]}', ARRAY['units'], '"km/h"'::jsonb);
                                                                                                          tjsonb_insert                                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {[{"speed": 10}@Sat Jan 01 00:00:00 2000 PST, {"speed": 20}@Sun Jan 02 00:00:00 2000 PST, {"speed": 30}@Mon Jan 03 00:00:00 2000 PST], [{"geom": 30}@Tue Jan 04 00:00:00 2000 PST, {"speed": 30}@Wed Jan 05 00:00:00 2000 PST]}
(1 row)

SELECT tjsonb_extract_path(tjsonb '"{\"speed\": 10, \"units\": \"km/h\"}"@2000-01-01', ARRAY['speed']);
       tjsonb_extract_path       
---------------------------------
 10@Sat Jan 01 00:00:00 2000 PST
(1 row)

SELECT tjsonb_extract_path(tjsonb '{{"speed": 10, "units": "km/h"}@2000-01-01, {"speed": 20, "units": "km/h"}@2000-01-02, {"speed": 10, "units": "km/h"}@2000-01-03}', ARRAY['speed']);
                                         tjsonb_extract_path                                         
-----------------------------------------------------------------------------------------------------
 {10@Sat Jan 01 00:00:00 2000 PST, 20@Sun Jan 02 00:00:00 2000 PST, 10@Mon Jan 03 00:00:00 2000 PST}
(1 row)

SELECT tjsonb_extract_path(tjsonb '[{"speed": 10, "units": "km/h"}@2000-01-01, {"speed": 20, "units": "km/h"}@2000-01-02, {"speed": 10, "units": "km/h"}@2000-01-03]', ARRAY['speed']);
                                          tjsonb_extract_path                                          
-------------------------------------------------------------------------------------------------------
 {[10@Sat Jan 01 00:00:00 2000 PST, 20@Sun Jan 02 00:00:00 2000 PST, 10@Mon Jan 03 00:00:00 2000 PST]}
(1 row)

SELECT tjsonb_extract_path(tjsonb '{[{"speed": 10}@2000-01-01, {"speed": 20, "units": "km/h"}@2000-01-02, {"speed": 10, "units": "km/h"}@2000-01-03],[{"geom": "Point(1 1)", "units": "km/h"}@2000-01-04, {"speed": 30, "units": "km/h"}@2000-01-05]}', ARRAY['speed']);
                                                                             tjsonb_extract_path                                                                             
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {[10@Sat Jan 01 00:00:00 2000 PST, 20@Sun Jan 02 00:00:00 2000 PST, 10@Mon Jan 03 00:00:00 2000 PST], [null@Tue Jan 04 00:00:00 2000 PST, 30@Wed Jan 05 00:00:00 2000 PST]}
(1 row)

/* Null handling */
SELECT tjsonb_extract_path(tjsonb '{[{"speed": 10}@2000-01-01, {"speed": 20, "units": "km/h"}@2000-01-02, {"speed": 10, "units": "km/h"}@2000-01-03],[{"geom": "Point(1 1)", "units": "km/h"}@2000-01-04, {"speed": 30, "units": "km/h"}@2000-01-05]}', ARRAY['speed'],'raise_exception');
ERROR:  The lifted operation returned NULL
SELECT tjsonb_extract_path(tjsonb '{[{"speed": 10}@2000-01-01, {"speed": 20, "units": "km/h"}@2000-01-02, {"speed": 10, "units": "km/h"}@2000-01-03],[{"geom": "Point(1 1)", "units": "km/h"}@2000-01-04, {"speed": 30, "units": "km/h"}@2000-01-05]}', ARRAY['speed'],'use_json_null');
                                                                             tjsonb_extract_path                                                                             
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {[10@Sat Jan 01 00:00:00 2000 PST, 20@Sun Jan 02 00:00:00 2000 PST, 10@Mon Jan 03 00:00:00 2000 PST], [null@Tue Jan 04 00:00:00 2000 PST, 30@Wed Jan 05 00:00:00 2000 PST]}
(1 row)

SELECT tjsonb_extract_path(tjsonb '{[{"speed": 10}@2000-01-01, {"speed": 20, "units": "km/h"}@2000-01-02, {"speed": 10, "units": "km/h"}@2000-01-03],[{"geom": "Point(1 1)", "units": "km/h"}@2000-01-04, {"speed": 30, "units": "km/h"}@2000-01-05]}', ARRAY['speed'],'delete_key');
                                                           tjsonb_extract_path                                                            
------------------------------------------------------------------------------------------------------------------------------------------
 {[10@Sat Jan 01 00:00:00 2000 PST, 20@Sun Jan 02 00:00:00 2000 PST, 10@Mon Jan 03 00:00:00 2000 PST], [30@Wed Jan 05 00:00:00 2000 PST]}
(1 row)

SELECT tjsonb_extract_path(tjsonb '{[{"speed": 10}@2000-01-01, {"speed": 20, "units": "km/h"}@2000-01-02, {"speed": 10, "units": "km/h"}@2000-01-03],[{"geom": "Point(1 1)", "units": "km/h"}@2000-01-04, {"speed": 30, "units": "km/h"}@2000-01-05]}', ARRAY['speed'],'return_null');
 tjsonb_extract_path 
---------------------
 
(1 row)

SELECT tjsonb '"{\"speed\": 10, \"units\": \"km/h\"}"@2000-01-01' #> ARRAY['speed'];
            ?column?             
---------------------------------
 10@Sat Jan 01 00:00:00 2000 PST
(1 row)

SELECT tjsonb '{{"speed": 10, "units": "km/h"}@2000-01-01, {"speed": 20, "units": "km/h"}@2000-01-02, {"speed": 10, "units": "km/h"}@2000-01-03}' #> ARRAY['speed'];
                                              ?column?                                               
-----------------------------------------------------------------------------------------------------
 {10@Sat Jan 01 00:00:00 2000 PST, 20@Sun Jan 02 00:00:00 2000 PST, 10@Mon Jan 03 00:00:00 2000 PST}
(1 row)

SELECT tjsonb '[{"speed": 10, "units": "km/h"}@2000-01-01, {"speed": 20, "units": "km/h"}@2000-01-02, {"speed": 10, "units": "km/h"}@2000-01-03]' #> ARRAY['speed'];
                                               ?column?                                                
-------------------------------------------------------------------------------------------------------
 {[10@Sat Jan 01 00:00:00 2000 PST, 20@Sun Jan 02 00:00:00 2000 PST, 10@Mon Jan 03 00:00:00 2000 PST]}
(1 row)

SELECT tjsonb '{[{"speed": 10}@2000-01-01, {"speed": 20, "units": "km/h"}@2000-01-02, {"speed": 10, "units": "km/h"}@2000-01-03],[{"speed": "30", "units": "km/h"}@2000-01-04, {"speed": 30, "units": "km/h"}@2000-01-05]}' #> ARRAY['speed'];
                                                                                  ?column?                                                                                   
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {[10@Sat Jan 01 00:00:00 2000 PST, 20@Sun Jan 02 00:00:00 2000 PST, 10@Mon Jan 03 00:00:00 2000 PST], ["30"@Tue Jan 04 00:00:00 2000 PST, 30@Wed Jan 05 00:00:00 2000 PST]}
(1 row)

/* Null handling */
SELECT tjsonb '{[{"speed": 10}@2000-01-01, {"speed": 20, "units": "km/h"}@2000-01-02, {"speed": 10, "units": "km/h"}@2000-01-03],[{"speed": "30", "units": "km/h"}@2000-01-04, {"speed": 30, "units": "km/h"}@2000-01-05]}' #> ARRAY['units'];
                                                                                          ?column?                                                                                           
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {[null@Sat Jan 01 00:00:00 2000 PST, "km/h"@Sun Jan 02 00:00:00 2000 PST, "km/h"@Mon Jan 03 00:00:00 2000 PST], ["km/h"@Tue Jan 04 00:00:00 2000 PST, "km/h"@Wed Jan 05 00:00:00 2000 PST]}
(1 row)

SELECT tjsonb_extract_path_text(tjsonb '"{\"speed\": 10, \"units\": \"km/h\"}"@2000-01-01', ARRAY['speed']);
    tjsonb_extract_path_text     
---------------------------------
 10@Sat Jan 01 00:00:00 2000 PST
(1 row)

SELECT tjsonb_extract_path_text(tjsonb '{{"speed": 10, "units": "km/h"}@2000-01-01, {"speed": 20, "units": "km/h"}@2000-01-02, {"speed": 10, "units": "km/h"}@2000-01-03}', ARRAY['speed']);
                                      tjsonb_extract_path_text                                       
-----------------------------------------------------------------------------------------------------
 {10@Sat Jan 01 00:00:00 2000 PST, 20@Sun Jan 02 00:00:00 2000 PST, 10@Mon Jan 03 00:00:00 2000 PST}
(1 row)

SELECT tjsonb_extract_path_text(tjsonb '[{"speed": 10, "units": "km/h"}@2000-01-01, {"speed": 20, "units": "km/h"}@2000-01-02, {"speed": 10, "units": "km/h"}@2000-01-03]', ARRAY['speed']);
                                       tjsonb_extract_path_text                                        
-------------------------------------------------------------------------------------------------------
 {[10@Sat Jan 01 00:00:00 2000 PST, 20@Sun Jan 02 00:00:00 2000 PST, 10@Mon Jan 03 00:00:00 2000 PST]}
(1 row)

SELECT tjsonb_extract_path_text(tjsonb '{[{"speed": 10}@2000-01-01, {"speed": 20, "units": "km/h"}@2000-01-02, {"speed": 10, "units": "km/h"}@2000-01-03],[{"geom": "Point(1 1)", "units": "km/h"}@2000-01-04, {"speed": 30, "units": "km/h"}@2000-01-05]}', ARRAY['speed']);
                                                                          tjsonb_extract_path_text                                                                           
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {[10@Sat Jan 01 00:00:00 2000 PST, 20@Sun Jan 02 00:00:00 2000 PST, 10@Mon Jan 03 00:00:00 2000 PST], [null@Tue Jan 04 00:00:00 2000 PST, 30@Wed Jan 05 00:00:00 2000 PST]}
(1 row)

/* Null handling */
SELECT tjsonb_extract_path_text(tjsonb '{[{"speed": 10}@2000-01-01, {"speed": 20, "units": "km/h"}@2000-01-02, {"speed": 10, "units": "km/h"}@2000-01-03],[{"geom": "Point(1 1)", "units": "km/h"}@2000-01-04, {"speed": 30, "units": "km/h"}@2000-01-05]}', ARRAY['units'], 'raise_exception');
ERROR:  The lifted operation returned NULL
SELECT tjsonb_extract_path_text(tjsonb '{[{"speed": 10}@2000-01-01, {"speed": 20, "units": "km/h"}@2000-01-02, {"speed": 10, "units": "km/h"}@2000-01-03],[{"geom": "Point(1 1)", "units": "km/h"}@2000-01-04, {"speed": 30, "units": "km/h"}@2000-01-05]}', ARRAY['units'], 'use_json_null');
                                                                              tjsonb_extract_path_text                                                                               
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {[null@Sat Jan 01 00:00:00 2000 PST, km/h@Sun Jan 02 00:00:00 2000 PST, km/h@Mon Jan 03 00:00:00 2000 PST], [km/h@Tue Jan 04 00:00:00 2000 PST, km/h@Wed Jan 05 00:00:00 2000 PST]}
(1 row)

SELECT tjsonb_extract_path_text(tjsonb '{[{"speed": 10}@2000-01-01, {"speed": 20, "units": "km/h"}@2000-01-02, {"speed": 10, "units": "km/h"}@2000-01-03],[{"geom": "Point(1 1)", "units": "km/h"}@2000-01-04, {"speed": 30, "units": "km/h"}@2000-01-05]}', ARRAY['units'], 'delete_key');
                                                             tjsonb_extract_path_text                                                             
--------------------------------------------------------------------------------------------------------------------------------------------------
 {[km/h@Sun Jan 02 00:00:00 2000 PST, km/h@Mon Jan 03 00:00:00 2000 PST], [km/h@Tue Jan 04 00:00:00 2000 PST, km/h@Wed Jan 05 00:00:00 2000 PST]}
(1 row)

SELECT tjsonb_extract_path_text(tjsonb '{[{"speed": 10}@2000-01-01, {"speed": 20, "units": "km/h"}@2000-01-02, {"speed": 10, "units": "km/h"}@2000-01-03],[{"geom": "Point(1 1)", "units": "km/h"}@2000-01-04, {"speed": 30, "units": "km/h"}@2000-01-05]}', ARRAY['units'], 'return_null');
 tjsonb_extract_path_text 
--------------------------
 
(1 row)

SELECT tjsonb '"{\"speed\": 10, \"units\": \"km/h\"}"@2000-01-01' #>> ARRAY['speed'];
            ?column?             
---------------------------------
 10@Sat Jan 01 00:00:00 2000 PST
(1 row)

SELECT tjsonb '{{"speed": 10, "units": "km/h"}@2000-01-01, {"speed": 20, "units": "km/h"}@2000-01-02, {"speed": 10, "units": "km/h"}@2000-01-03}' #>> ARRAY['speed'];
                                              ?column?                                               
-----------------------------------------------------------------------------------------------------
 {10@Sat Jan 01 00:00:00 2000 PST, 20@Sun Jan 02 00:00:00 2000 PST, 10@Mon Jan 03 00:00:00 2000 PST}
(1 row)

SELECT tjsonb '[{"speed": 10, "units": "km/h"}@2000-01-01, {"speed": 20, "units": "km/h"}@2000-01-02, {"speed": 10, "units": "km/h"}@2000-01-03]' #>> ARRAY['speed'];
                                               ?column?                                                
-------------------------------------------------------------------------------------------------------
 {[10@Sat Jan 01 00:00:00 2000 PST, 20@Sun Jan 02 00:00:00 2000 PST, 10@Mon Jan 03 00:00:00 2000 PST]}
(1 row)

SELECT tjsonb '{[{"speed": 10}@2000-01-01, {"speed": 20, "units": "km/h"}@2000-01-02, {"speed": 10, "units": "km/h"}@2000-01-03],[{"geom": "Point(1 1)", "units": "km/h"}@2000-01-04, {"speed": 30, "units": "km/h"}@2000-01-05]}' #>> ARRAY['speed'];
                                                                                  ?column?                                                                                   
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {[10@Sat Jan 01 00:00:00 2000 PST, 20@Sun Jan 02 00:00:00 2000 PST, 10@Mon Jan 03 00:00:00 2000 PST], [null@Tue Jan 04 00:00:00 2000 PST, 30@Wed Jan 05 00:00:00 2000 PST]}
(1 row)

SELECT tjsonb '"{\"speed\": 10, \"units\": \"km/h\"}"@2000-01-01' -> 'speed';
            ?column?             
---------------------------------
 10@Sat Jan 01 00:00:00 2000 PST
(1 row)

SELECT tjsonb '{{"speed": 10, "units": "km/h"}@2000-01-01, {"speed": 20, "units": "km/h"}@2000-01-02, {"speed": 10, "units": "km/h"}@2000-01-03}' -> 'speed';
                                              ?column?                                               
-----------------------------------------------------------------------------------------------------
 {10@Sat Jan 01 00:00:00 2000 PST, 20@Sun Jan 02 00:00:00 2000 PST, 10@Mon Jan 03 00:00:00 2000 PST}
(1 row)

SELECT tjsonb '[{"speed": 10, "units": "km/h"}@2000-01-01, {"speed": 20, "units": "km/h"}@2000-01-02, {"speed": 10, "units": "km/h"}@2000-01-03]' -> 'speed';
                                               ?column?                                                
-------------------------------------------------------------------------------------------------------
 {[10@Sat Jan 01 00:00:00 2000 PST, 20@Sun Jan 02 00:00:00 2000 PST, 10@Mon Jan 03 00:00:00 2000 PST]}
(1 row)

SELECT tjsonb '{[{"speed": 10}@2000-01-01, {"speed": 20, "units": "km/h"}@2000-01-02, {"speed": 10, "units": "km/h"}@2000-01-03],[{"geom": "Point(1 1)", "units": "km/h"}@2000-01-04, {"speed": 30, "units": "km/h"}@2000-01-05]}' -> 'speed';
                                                                                  ?column?                                                                                   
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {[10@Sat Jan 01 00:00:00 2000 PST, 20@Sun Jan 02 00:00:00 2000 PST, 10@Mon Jan 03 00:00:00 2000 PST], [null@Tue Jan 04 00:00:00 2000 PST, 30@Wed Jan 05 00:00:00 2000 PST]}
(1 row)

SELECT tjsonb '"{\"speed\": 10, \"units\": \"km/h\"}"@2000-01-01' ->> 'speed';
            ?column?             
---------------------------------
 10@Sat Jan 01 00:00:00 2000 PST
(1 row)

SELECT tjsonb '{{"speed": 10, "units": "km/h"}@2000-01-01, {"speed": 20, "units": "km/h"}@2000-01-02, {"speed": 10, "units": "km/h"}@2000-01-03}' ->> 'speed';
                                              ?column?                                               
-----------------------------------------------------------------------------------------------------
 {10@Sat Jan 01 00:00:00 2000 PST, 20@Sun Jan 02 00:00:00 2000 PST, 10@Mon Jan 03 00:00:00 2000 PST}
(1 row)

SELECT tjsonb '[{"speed": 10, "units": "km/h"}@2000-01-01, {"speed": 20, "units": "km/h"}@2000-01-02, {"speed": 10, "units": "km/h"}@2000-01-03]' ->> 'speed';
                                               ?column?                                                
-------------------------------------------------------------------------------------------------------
 {[10@Sat Jan 01 00:00:00 2000 PST, 20@Sun Jan 02 00:00:00 2000 PST, 10@Mon Jan 03 00:00:00 2000 PST]}
(1 row)

SELECT tjsonb '{[{"speed": 10}@2000-01-01, {"speed": 20, "units": "km/h"}@2000-01-02, {"speed": 10, "units": "km/h"}@2000-01-03],[{"geom": "Point(1 1)", "units": "km/h"}@2000-01-04, {"speed": 30, "units": "km/h"}@2000-01-05]}' ->> 'speed';
                                                                                  ?column?                                                                                   
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {[10@Sat Jan 01 00:00:00 2000 PST, 20@Sun Jan 02 00:00:00 2000 PST, 10@Mon Jan 03 00:00:00 2000 PST], [null@Tue Jan 04 00:00:00 2000 PST, 30@Wed Jan 05 00:00:00 2000 PST]}
(1 row)

SELECT tint(tjsonb '"{\"a\":true, \"b\":2.5}"@2001-01-01', text 'a');
              tint              
--------------------------------
 1@Mon Jan 01 00:00:00 2001 PST
(1 row)

SELECT tint(tjsonb '"{\"a\":1, \"b\":2.5}"@2001-01-01', text 'a');
              tint              
--------------------------------
 1@Mon Jan 01 00:00:00 2001 PST
(1 row)

SELECT tint(tjsonb '"{\"a\":1, \"b\":2.5}"@2001-01-01', text 'b');
              tint              
--------------------------------
 2@Mon Jan 01 00:00:00 2001 PST
(1 row)

SELECT tint(tjsonb '"{\"a\":\"1\", \"b\":2.5}"@2001-01-01', text 'a');
              tint              
--------------------------------
 1@Mon Jan 01 00:00:00 2001 PST
(1 row)

SELECT tfloat(tjsonb '"{\"a\":true, \"b\":2.5}"@2001-01-01', text 'a');
             tfloat             
--------------------------------
 1@Mon Jan 01 00:00:00 2001 PST
(1 row)

SELECT tfloat(tjsonb '"{\"a\":1, \"b\":2.5}"@2001-01-01', text 'a');
             tfloat             
--------------------------------
 1@Mon Jan 01 00:00:00 2001 PST
(1 row)

SELECT tfloat(tjsonb '"{\"a\":1, \"b\":2.5}"@2001-01-01', text 'b');
              tfloat              
----------------------------------
 2.5@Mon Jan 01 00:00:00 2001 PST
(1 row)

/* Errors */
SELECT tint(tjsonb '"{\"a\":1, \"b\":2.5}"@2001-01-01', text 'xxx');
ERROR:  The lifted operation returned NULL
SELECT tint(tjsonb '"{\"a\":\"xxx\", \"b\":2.5}"@2001-01-01', text 'a');
ERROR:  Invalid numeric string for key "a": xxx
